# Redis Sentinel 설정 (HA Step 3)
#
# 각 Sentinel 컨테이너가 이 파일을 템플릿으로 복사하여 사용한다.
# Sentinel은 런타임에 config 파일을 수정하므로 원본이 아닌 복사본에서 실행해야 한다.
#
# 주요 설정:
#   - quorum 2: Sentinel 3대 중 2대가 동의해야 failover 진행
#   - down-after-milliseconds 5000: Master 무응답 5초 후 주관적 다운(sdown) 판정
#   - failover-timeout 10000: failover 전체 타임아웃 10초
#
# IP 기반 모니터링:
#   Docker 환경에서 docker kill 시 컨테이너 hostname(DNS)이 사라지는 문제를 방지하기 위해
#   hostname 대신 고정 IP로 Master를 감시한다.
#   컨테이너가 죽어도 IP는 유지되므로 connection refused → sdown → failover 정상 진행.

port 26379

sentinel monitor mymaster 172.22.0.10 6379 2
sentinel down-after-milliseconds mymaster 5000
sentinel failover-timeout mymaster 10000
