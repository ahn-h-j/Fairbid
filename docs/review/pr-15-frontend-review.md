# PR #15 리뷰 분석

> **PR**: feat: 프론트엔드 UI 구현 (경매 등록/상세 페이지)
> **URL**: https://github.com/ahn-h-j/Fairbid/pull/15
> **리뷰어**: CodeRabbit, GitHub Copilot
> **분석일**: 2026-01-12

---

## CodeRabbit 리뷰

### 1. Gradle wrapper 호출 방식 불일치
- **파일**: `backend/gradlew:211-214`
- **내용**: backend/gradlew는 `-jar` 방식을 사용하지만 루트 gradlew는 `-classpath` + 메인 클래스 방식을 사용함. 서로 다른 버전의 Gradle wrapper로 생성된 것으로 보임
- **판정**: ⚠️ 선택적
- **AI 분석**: 기능상 문제는 없으나 일관성과 유지보수성 측면에서 동일한 Gradle 버전으로 wrapper를 재생성하는 것이 좋음. #2 해결 시 함께 해결됨
- **결정**: 수용
- **의견**: ai 동의

---

### 2. Gradle 버전 불일치 (루트 8.13 vs 백엔드 9.2.1)
- **파일**: `gradle/wrapper/gradle-wrapper.properties:3`
- **내용**: 루트 프로젝트는 Gradle 8.13, backend는 9.2.1 사용. 모노레포에서 버전 불일치는 빌드 일관성 문제 발생 가능
- **판정**: ✅ 수용
- **AI 분석**: CI에서는 루트의 gradlew를 사용하고, Docker 빌드에서는 backend의 gradlew를 사용함. 환경별로 다른 Gradle 버전 사용 시 예측 불가능한 빌드 결과 발생 가능. 버전 통일 필요
- **결정**: 수용
- **의견**: ai 동의

---

### 3. startPrice 변경 시 instantBuyPrice 유효성 검사 미실행
- **파일**: `frontend/create.html:168-177`
- **내용**: instantBuyPrice 입력 이벤트에서만 유효성 검사 실행. startPrice를 나중에 더 높게 변경하면 검증이 다시 실행되지 않아 잘못된 값 제출 가능
- **판정**: ⚠️ 선택적
- **AI 분석**: 백엔드에서 `Auction.java:64-65`에서 동일한 검증 수행. 프론트 검증은 UX 개선용으로 필수는 아님
- **결정**: 수용
- **의견**: UX 측면에서 미리 화면에 보여주는 것이 바람직해 보임

---

### 4. submitBid에서 직접 입찰 버튼 비활성화 누락
- **파일**: `frontend/index.html:296-310`
- **내용**: submitBid 함수에서 원터치 입찰 버튼만 비활성화하고 직접 입찰 버튼은 비활성화하지 않아 중복 요청 가능
- **판정**: ✅ 수용
- **AI 분석**: 입찰 요청 중 직접 입찰 버튼 클릭 시 중복 입찰 발생 가능. 금전적 문제로 이어질 수 있는 버그
- **결정**: 수용
- **의견**: 둘다 비활성화하는 것이 맞음

---

### 5. WebSocket 재연결 로직이 의도적 연결 해제 후에도 실행
- **파일**: `frontend/js/websocket.js:29-40`
- **내용**: disconnectWebSocket() 호출 후에도 이전에 설정된 setTimeout 재연결 타이머가 실행되어 불필요한 연결 시도 발생
- **판정**: ⚠️ 선택적
- **AI 분석**: 현재 MPA(Multi-Page Application) 구조에서는 페이지 이탈 시 JS 컨텍스트가 사라져 실질적 문제 없음. SPA 전환 시 필요
- **결정**: 거부
- **의견**: ai 동의

---

### 6. WebSocket JSON 파싱 오류 처리 누락
- **파일**: `frontend/js/websocket.js:60-65`
- **내용**: stompClient.subscribe 콜백에서 JSON.parse 오류 처리 없음. 잘못된 형식의 메시지 수신 시 핸들러 중단
- **판정**: ✅ 수용
- **AI 분석**: 서버에서 잘못된 메시지 전송 시 전체 WebSocket 핸들러가 중단됨. try-catch로 감싸는 방어적 코딩 필요
- **결정**: 수용
- **의견**: 네트워크 오류등 예상치 못한 버그가 발생하였을 경우 대비가 필요

---

### 7. API 응답 JSON 파싱 오류 처리 불명확
- **파일**: `frontend/js/api.js:51-69`
- **내용**: 서버가 HTML 오류 페이지(예: nginx 502)를 반환할 경우 response.json()이 실패하여 NETWORK_ERROR로 래핑됨. 실제 원인 파악 어려움
- **판정**: ⚠️ 선택적
- **AI 분석**: 현재도 NETWORK_ERROR로 사용자에게 오류 표시됨. 디버깅 편의 개선 사항
- **결정**: 수용
- **의견**: 에러메세지는 어느정도 디테일할 필요가 있음

---

### 8. nginx 베이스 이미지 버전 고정 권장
- **파일**: `frontend/Dockerfile:1`
- **내용**: nginx:alpine은 최신 버전을 가리키므로 빌드 재현성을 위해 특정 버전 명시 권장 (예: nginx:1.25-alpine)
- **판정**: ⚠️ 선택적
- **AI 분석**: 프로덕션 환경에서는 버전 고정 필수. 포트폴리오/개발 환경에서는 최신 버전 사용도 무방
- **결정**: 수용
- **의견**: 항상 최신 버전으로 돌아가면 예기치 못한 문제 발생가능성 있음

---

### 9. docker-compose healthcheck 추가 권장
- **파일**: `docker-compose.yml:2-22`
- **내용**: depends_on은 서비스 시작 순서만 보장하며 백엔드가 요청 준비 완료되었는지는 보장하지 않음. healthcheck 추가 권장
- **판정**: ⚠️ 선택적
- **AI 분석**: 개발 환경에서는 초기 요청 실패 시 재시도하면 됨. 프로덕션 환경에서는 필요
- **결정**: 거부
- **의견**: 두 방식 모두 초반 api 실패 가능성 있는것은 동일해보임

---

### 10. nginx gzip 압축 및 캐싱 설정 추가 권장
- **파일**: `frontend/nginx.conf:5-8`
- **내용**: 프로덕션 환경 성능 향상을 위해 gzip 압축과 캐시 헤더 설정 추가 권장
- **판정**: ⚠️ 선택적
- **AI 분석**: 정적 파일이 적고 로컬 개발 환경에서는 체감 효과 미미. 프로덕션 배포 시 고려
- **결정**: 거부
- **의견**: 프론트 코드 자체가 적기에 굳이 필요하지 않음

---

### 11. gradlew.bat 호출 방식 불일치
- **파일**: `backend/gradlew.bat:73-76`
- **내용**: 루트 gradlew.bat는 CLASSPATH 방식, backend는 -jar 방식 사용. 일관성 문제
- **판정**: ⚠️ 선택적
- **AI 분석**: #1과 동일 문제. #2 Gradle 버전 통일 시 함께 해결됨
- **결정**: 패스
- **의견**: 위에서 응답함

---

### 12. CSS 변수 사용 권장
- **파일**: `frontend/css/style.css:304-317`
- **내용**: alert-success, alert-error 등의 색상이 하드코딩됨. :root에 정의된 CSS 변수와 일관성 유지 권장
- **판정**: ⚠️ 선택적
- **AI 분석**: 테마 변경 시 유지보수 용이. 현재 테마 변경 계획이 없다면 불필요
- **결정**: 수용
- **의견**: 다른페이지에서도 같은 값을 쓸수 있게 하는것이 중요

---

### 13. CDN 스크립트 SRI 해시 추가 권장
- **파일**: `frontend/index.html:9-10`
- **내용**: 외부 CDN 스크립트에 Subresource Integrity(SRI) 해시를 추가하여 스크립트 무결성 검증 권장
- **판정**: ⚠️ 선택적
- **AI 분석**: 보안 강화 측면에서 좋은 제안. CDN 손상 가능성은 낮으나 프로덕션에서는 권장
- **결정**: 거부
- **의견**: 과한 설정

---

### 14. 클라이언트 측 상태 계산 서버 불일치 가능성
- **파일**: `frontend/index.html:253-270`
- **내용**: nextMinBidPrice와 totalBidCount를 클라이언트에서 직접 계산/증가. WebSocket 메시지에 해당 값이 포함되어 있다면 서버 값 사용 권장
- **판정**: ⚠️ 선택적
- **AI 분석**: 현재 백엔드 BidUpdateMessage에 해당 필드 없음. 프론트 수정이 아닌 백엔드 수정 필요 사항
- **결정**: 수용
- **의견**: 백엔드에서 처리한 후 프론트로 넘기는게 정합성 보장

---

## Copilot 리뷰

### 1. Gradle 버전 다운그레이드
- **파일**: `gradle/wrapper/gradle-wrapper.properties:3`
- **내용**: Gradle 9.2.1에서 8.13으로 다운그레이드됨. 새로운 기능과 버그 수정 접근성 상실. 호환성 문제가 없다면 9.2.1 유지 권장
- **판정**: ✅ 수용
- **AI 분석**: CodeRabbit #2와 동일 이슈. 버전 통일 필요하며, 어느 버전으로 통일할지는 선택 사항
- **결정**: 수용
- **의견**: 버전 일치해야 예측불가능한 버그 확률이 줄어들거 같음

---

### 2. WebSocket 재연결 플래그 필요
- **파일**: `frontend/js/websocket.js:38`
- **내용**: 의도적 연결 해제(예: 사용자 페이지 이탈)와 오류로 인한 연결 해제를 구분하는 플래그 필요
- **판정**: ⚠️ 선택적
- **AI 분석**: CodeRabbit #5와 동일 이슈. 현재 MPA 구조에서는 실질적 문제 없음
- **결정**: 패스
- **의견**: 위에서 답변

---

## 요약

| 판정 | 개수 | 항목 |
|------|------|------|
| ✅ 수용 | 4개 | Gradle 버전 통일, 입찰 버튼 비활성화, JSON 파싱 오류 처리 |
| ⚠️ 선택적 | 12개 | WebSocket 재연결, nginx 설정, CSS 변수, SRI 해시 등 |
| ❌ 거부 | 0개 | - |
